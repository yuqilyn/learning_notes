## JWT Attack
### 什么是JWT攻击?
`JWT 攻击涉及用户向服务器发送修改后的 JWT，以实现恶意目标。通常，此目标是通过冒充已通过身份验证的另一个用户来绕过身份验证和访问控制。`
### JWT漏洞产生的原因
`JWT 漏洞通常是由于应用程序本身的 JWT 处理存在缺陷而引起的:`</br>
`  1、JWT 相关的各种规范在设计上相对灵活，允许网站开发人员自己决定许多实现细节。这就导致有些开发人员在设计的时候对JWT的签名没有做到正确的验证,这使得攻击者能够篡改通过令牌的有效负载传递给应用程序的值。`</br>
`  2、即使签名经过了严格的验证，它是否真正值得信任在很大程度上取决于服务器的密钥是否保密。如果该密钥以某种方式泄露，或者被猜测或暴力破解，攻击者可以为任意令牌生成有效签名，从而危及整个机制。`</br>
### JWT攻击造成的影响
`如果攻击者能够创建具有任意值的有效令牌，他们就可能提升自己的权限或冒充其他用户，从而完全控制他们的帐户。`
### 如何防止JWT攻击
`1、使用最新的库来处理 JWT，并确保您的开发人员完全了解其工作原理以及任何安全隐患，现代库使您更难以无意中以不安全的方式实现它们，但由于相关规范固有的灵活性，这并非万无一失。`</br>
`2、确保对收到的任何 JWT 执行正确有效的签名验证，并考虑使用意外算法签名的 JWT 等边缘情况。`<br/>
`3、针对 jku 标头强制执行允许主机的严格白名单`</br>
`4、确保您不会通过 kid 标头参数受到路径遍历或 SQL 注入的攻击。`</br>
`5、为发行的任何令牌设置到期日期。`</br>
`6、尽可能避免在 URL 参数中发送令牌。`</br>
`7、使发行服务器能够撤销令牌（例如，在注销时）。`</br>

### 常见的JWT攻击方式(参考BP官网靶场)
#### 一、利用有缺陷的 JWT 签名验证（及未验证签名或验证不严格）
##### 漏洞产生原因
`根据设计，服务器通常不会存储有关其发出的 JWT 的任何信息。相反，每个令牌都是一个完全独立的实体。`<br/>
`这样做带来了一个根本问题——服务器实际上并不知道令牌的原始内容，甚至不知道原始签名是什么。`<br/>
`因此，如果服务器不能正确验证签名，就无法阻止攻击者对令牌的其余部分进行任意更改。`<br/>
##### （1）接受任意签名
```
JWT 库通常提供一种验证令牌的方法和另一种仅解码令牌的方法。例如，Node.js 库 jsonwebtoken 具有 verify() 和 decrypt()。
有时，开发人员会混淆这两种方法，只将传入的令牌传递给decode()方法。
这实际上意味着应用程序根本不验证签名。即接受任意签名，这就导致攻击者可以修改任意身份进行登录和越权操作
```
##### (2)接受无签名的token
`除其他内容外，JWT 标头还包含一个 alg 参数。这会告诉服务器使用哪种算法对令牌进行签名，以及在验证签名时需要使用哪种算法。`
